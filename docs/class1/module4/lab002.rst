Lab – Logon Protection Configuration
------------------------------------------------

In this section, modify the existing IAP Policy 

Task – Enable Logon Protection in the GUI
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

1. Click **Logon Protection** in the Ribbon

|image3|

2. Check **Enable Logon Page Protection** 
3. Click **Save & Next**

|image4|

3. Click **Deploy**

|image5|


4. Click **Guided Configuration** about the Ribbon

|image6|

5. Click the closed **Lock** to disable Strict Updates

|image7|


6.  Check **Are you Sure you want to disable Manage Configuration?**
7. Click **OK**

|image8|

8. Click **Apply Access Policy** in the top left corner near the F5 logo.

|image9|

9. Click **Apply**

|image10|


Task – Enable Logon Protection in the GUI
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

10.  On the Jumpbox, Click the Putty Icon for **BIGIP1** to establish an SSH Connection

|image11|


11. You should auto login to TMOS

|image12|

12. Locate the file **logon Protection.txt** in the **C:\\LabFiles\\Agility2020-Identity Aware Proxy**

|image13|

13. Open the **logon protection.txt** file with Notepad++ and copy its contents

|image14|

.. note :: modify /security anti-fraud profile IAP_DEMO.app/datasafe urls replace-all-with { /vdesk/agent_logon_page_form.eui* { include-query-string enabled type wildcard login-response { status-code 302 validation enabled } parameters add { username { identify-as-username enabled encrypt enabled obfuscate enabled substitute-value enabled } password { encrypt enabled obfuscate enabled substitute-value enabled } _F5_verify_password { encrypt enabled obfuscate enabled substitute-value enabled } _F5_challenge { encrypt enabled obfuscate enabled substitute-value enabled } } } }

14. Paste the contents of the file to **BIG-IP1** via the established SSH session.

|image15|



Task – View the changes from basic0-iap.acme.com
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

15.  From the jump box, access the website **https://basic-iap.acme.com**

|image16|

16. Right click the password field and click **Inspect**

|image17|


17. Notice the name of the parameter is now obfuscated.

.. note :: If you watch the screen every few seconds the parameters is changed.  This is to ensure malware cannot be written to determine the parameter name

|image18|

18. Enter Username: **user1** and Password: **user1** into the logon page

|image19|

19.  Notice as you type the password the value of parameter is actually encrypted real-time.

|image20|

.. |image3| image:: /_static/class1/module4/image003.png
.. |image4| image:: /_static/class1/module4/image004.png
.. |image5| image:: /_static/class1/module4/image005.png
.. |image6| image:: /_static/class1/module4/image006.png
.. |image7| image:: /_static/class1/module4/image007.png
.. |image8| image:: /_static/class1/module4/image008.png
.. |image9| image:: /_static/class1/module4/image009.png
.. |image10| image:: /_static/class1/module4/image010.png
.. |image11| image:: /_static/class1/module4/image011.png
.. |image12| image:: /_static/class1/module4/image012.png
.. |image13| image:: /_static/class1/module4/image013.png
.. |image14| image:: /_static/class1/module4/image014.png
.. |image15| image:: /_static/class1/module4/image015.png
.. |image16| image:: /_static/class1/module4/image016.png
.. |image17| image:: /_static/class1/module4/image017.png
.. |image18| image:: /_static/class1/module4/image018.png
.. |image19| image:: /_static/class1/module4/image019.png
.. |image20| image:: /_static/class1/module4/image020.png
